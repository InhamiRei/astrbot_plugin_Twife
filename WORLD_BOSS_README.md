# 世界 Boss 系统说明文档

## 功能概述

世界 Boss 系统是一个全服协作的战斗系统，玩家可以通过自己的老婆攻击强大的 Boss，获得丰厚的奖励。

## 核心功能

### 1. 两个主要命令

- `世界boss` - 查看当前 Boss 状态和伤害排行榜
- `攻击boss` - 攻击世界 Boss（消耗 30 健康值）

### 2. Boss 机制

- **当前 Boss**: 可可萝（黑化）
- **三个阶段**:
  - 第 1 阶段：10,000 血量 - "初次黑化"
  - 第 2 阶段：50,000 血量 - "深度黑化"
  - 第 3 阶段：100,000 血量 - "完全黑化"
- **攻击成本**: 每次攻击消耗 30 点健康值
- **更新周期**: 每周更新一次（未来扩展）

### 3. 伤害计算公式

伤害计算包含以下因素：

#### 基础计算

- **等级影响**: 1-100 级，基础倍数 0.5-5.0
- **好感度影响**: 0-10000，基础倍数 0.1-2.0
- **特殊属性影响**:
  - 妹抖值：每点+2%伤害
  - 撒娇值：每点+1.5%伤害
  - 傲娇值：每点+2.5%伤害
  - 黑化率：每点+3%伤害
  - 反差萌：每点+2%伤害
- **装备加成**: 所有装备属性的总和
- **随机波动**: 80%-120%

#### 公式

```
最终伤害 = (基础伤害100 × 等级倍数 × 好感倍数 × 特殊属性倍数 × 随机倍数) + 装备加成
最小伤害 = 10
```

### 4. 奖励系统

#### 阶段奖励（每个阶段击败时发放）

- **第 1 阶段**: 500-1000 金币 + 1-3 个物品
- **第 2 阶段**: 1000-2000 金币 + 1-3 个物品
- **第 3 阶段**: 2000-5000 金币 + 1-3 个物品

#### 奖励物品池

- **基础奖励**: 可可萝的围裙、温暖的料理、美食食谱
- **高级奖励**: 可可萝的笑容、公主之心
- **终极奖励**: 可可萝的发夹、厨师的骄傲（珍稀收藏）

#### 最终排行榜

Boss 完全被击败后显示：

- 伤害排行榜前 10 名
- 总参与人数和总伤害
- 平均伤害统计

### 5. 数据存储

- `world_boss_data.json` - Boss 状态数据
- `world_boss_damage_records.json` - 玩家伤害记录

## 文件结构

```
core/
├── world_boss_system.py    # 核心系统逻辑
handlers/
├── world_boss_handler.py   # 命令处理器
config/
├── items_config.py        # 奖励物品配置（新增世界Boss物品）
main.py                    # 命令映射和初始化
```

## 技术实现特点

1. **模块化设计**: 遵循现有项目架构
2. **数据持久化**: 自动保存 Boss 状态和玩家记录
3. **装备系统集成**: 正确计算时装加成
4. **多阶段 Boss**: 支持 Boss 形态变化
5. **实时排行榜**: 动态显示伤害统计
6. **奖励分发**: 自动给所有参与者发放奖励

## 扩展计划

- 支持多种不同 Boss 轮换
- 添加更多奖励物品
- 优化伤害计算平衡性
- 增加 Boss 技能和特殊机制
